Backend -> cardatabase2ë¥¼ ê¸°ì¤€
Frontend -> carfrontend

# í™˜ê²½ ë³€ìˆ˜ ì´ìš©

ì„œë²„ URLì€ CRUD ê¸°ëŠ¥ì„ ë§Œë“¤ ë•Œ ì†ŒìŠ¤ ì½”ë“œì—ì„œ ì—¬ëŸ¬ ë²ˆ ë°˜ë³µë  ìˆ˜ ìˆìœ¼ë©°, ë°±ì—”ë“œê°€ ë°°í¬ê°€ ë˜ë©´ localhost:8080ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— í™˜ê²½ ë³€ìˆ˜ë¡œ ë¯¸ë¦¬ ì •ì˜í•´ë‘ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ ìˆ˜ì •ì´ ì´ë£¨ì–´ì§€ê³  ë‚˜ë©´ ê°±ì‹ ëœ GetCars()ê°€ ë‹¤ì‹œ ìš”ì²­ë˜ì–´ì•¼ í•  ê²ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ìˆ˜ì • ë¶€ë¶„ì— ìˆëŠ” localhost:8080ê³¼ ë‹¤ì‹œ getCars()ë¥¼ ìš”ì²­í•  ë•Œì˜ localhost:8080ì„ ë§¤ë²ˆ URLë¡œ ë‹¤ ê³ ì¹˜ëŠ”ê²ƒì€ ë¹„íš¨ìœ¨ ì ì´ë©° í•˜ë“œì½”ë”©ì´ë‹¤.

ê·¸ë˜ì„œ í™˜ê²½ë³€ìˆ˜ì— URLì„ ì €ì¥í•´ë‘ê²Œ ë˜ë©´, URLì´ ë°”ë€” ë•Œ í™˜ê²½ ë³€ìˆ˜ë§Œ ìˆ˜ì €í•´ì£¼ë©´ ì¼ê´„ ë³€í™˜ì´ ë  ê²ƒì´ê¸° ë•Œë¬´ë„¹ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •ì„ ë¯¸ë¦¬í•˜ê³  ë‹¤ìŒ ê³¼ì •ìœ¼ë¡œ ë„˜ì–´ ê°€ê² ìŠµë‹ˆã…ã„·.

vite project ìƒì—ì„œëŠ” í™˜ê²½ ë³€ìˆ˜ ì´ë¦„ì€ `VITE_`ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤. ì ‘ë‘ì‚¬ê°€ VITE\_ì¸ ë³€ìˆ˜ë§Œ ì†ŒìŠ¤ì½”ë“œì—ì„œ ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

1. ì•±ì˜ ë£¨íŠ¸ í´ë”ì˜ .envì— ìƒì„±.

   - .env íŒŒì¼ì´ ê°€ì¥ ìƒìœ„ rootí´ë”ì— ì¡´ì¬í•  ê²ƒ í™•ì¸ã€€ã€€
     `VITE_API_URL=http://localhost:8080`

2. src í´ë” ë‚´ì— api í´ë” ìƒì„± -> carapi.ts íŒŒì¼ ìƒì„±
   - ì´ìƒì˜ ëª¨ë“  API í˜¸ì¶œ í•¨ìˆ˜ë¥¼ ìì²´ ëª¨ë“ˆë¡œ ë¶„ë¦¬í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. ì¦‰ í˜„ì¬ ìƒí™©ì—ì„œëŠ” getCars()ë¥¼ Carlist ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶„ë¦¬í•´ì˜¤ê² ë‹¤ëŠ” ì˜ë¯¸ê°€ ë˜ê² ìŠµë‹ˆë‹¤.

# í˜ì´ì§• / í•„í„°ë§ / ì •ë ¬ ì¶”ê°€

- githubì—ì„œëŠ” Ag Grid ì‚¬ìš©, ì´ë²ˆì—ëŠ” MUIë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„± í•  ì˜ˆì •
- `npm install @mui/x-data-grid@8.4.0`

# ì‚­ì œ ê¸°ëŠ¥ ì¶”ê°€

- ì´ì œ ì¤‘ìš”í•œ ì ì€ ì‚­ì œë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” íŠ¹ì • rowë¥¼ ì„ íƒí•´ì•¼í•œë‹¤ëŠ” ì ê³¼, ì—”ë“œí¬ì¸íŠ¸ì— {id}ê°€ ì¶”ê°€ë˜ì–´ì•¼ í•œë‹¤ëŠ” ì ì´ë‹¤.
- ê·¼ë° ìš°ë¦¬ëŠ” ê° rowì— ëŒ€í•œ hrefë¥¼ ê°€ì§€ê³  ìˆë‹¤ëŠ” ì ì— ì£¼ëª©í•  í•„ìš”ê°€ ìˆë‹¤.

```json
"cars" : [ {
      "brand" : "Kia",
      "model" : "Seltos",
      "color" : "Chacol",
      "registrationNumber" : "370SU5690",
      "modelYear" : 2020,
      "price" : 30000000,
      "_links" : {
        "self" : {
          "href" : "http://127.0.0.1:8080/api/cars/1"
        },
        "car" : {
          "href" : "http://127.0.0.1:8080/api/cars/1"
        },
        "owner" : {
          "href" : "http://127.0.0.1:8080/api/cars/1/owner"
        }
      }
    }
```

HATEOASë¥¼ ì ìš©í–ˆê¸° ë•Œë¬¸ì— ê°ê°ì˜ id ê°’ì´ ìë™ìœ¼ë¡œ ì„¤ì •ë˜ì–´ìˆìŠµë‹ˆë‹¤. ì¦‰ DELETE methodë¥¼ \_link.self.hrefë¡œ ë³´ë‚´ì£¼ë©´ ì•Œì•„ì„œ ì‚­ì œê°€ ë ê±°ë¼ê³  ìƒê°í•  ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤.

ê·¸ë˜ì„œ í˜„ì¬ GET ìš”ì²­ì„ í†µí•´ì„œ `import.meta.env.VITE_API_URL/api/cars`ë¥¼ í•˜ê²Œ ëì„ ë•Œ x-data-gridì— ì˜í•´ì„œ ê° ìë™ì°¨ rowë“¤ì´ ë‚˜ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. x-data-gridì˜ GridColDefë¥¼ ìˆ˜ì •í•˜ì—¬ ë²„íŠ¼ í•˜ë‚˜ë¥¼ ì¶”ê°€í•˜ê³ , ê±°ê¸°ì— ì‚­ì œ ê¸°ëŠ¥ì„ ì ìš©í•  ê²ë‹ˆë‹¤.

ì™œëƒë©´ key ì†ì„±ì— ì´ë¯¸ \_link.self.href ê°’ì´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

GridColDefì— ë”¸ë¦° columns ìƒìˆ˜ë¥¼ ìˆ˜ì •í•˜ì—¬ í•˜ë‚˜ì˜ columnì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” Delete ë²„íŠ¼ì„ í• ë‹¹í–ˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì»¬ëŸ¼ë“¤ê³¼ ë‹¬ã„¹ ã…£ì„¸ì„¸í•œ ì»¤ìŠ¤í…€ì´ í•„ìš”í•˜ê¸° ë•Œë¬´ë„¹ renderCell ì»¬ëŸ¼ ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ì…€ì˜ ì»¨í…ì¸ ê°€ ë Œë”ë§ë˜ëŠ”ë°©ì‹ì„ ì •ì˜í–ˆìŠµë‹ˆë‹¤.(ì—¬ê¸°ì„œëŠ” ë²„íŠ¼íƒœê·¸ë¥¼ ë„£ìŒ)
ê·¸ë¦¬ê³  í˜„ì¬ ìƒí™©ì—ì„œëŠ” alertì„ í†µí•´ \_link.self.hrefë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ì§€ë¥¼ í™•ì¸í–ˆëŠ”ë°, ì—¬ê¸°ì„œ ì£¼ìš©í•œ ê°œë…ì´ onClick={alert(params.link.self.href)}ê³¼ì˜ ì°¨ì´ì ì„ ëª…í™•í•˜ê²Œ ì´í•´í•  í•„ìš”ê°€ ìˆë‹¤.

í•¨ìˆ˜ì˜ ì´ë¦„ì„ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ì „ë‹¬ / í•¨ìˆ˜ì˜ ê²°ê³¼ë¥¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ì „ë‹¬í•˜ëŠ” ê²ƒì˜ ì°¨ì´ì ì„ ë³µìŠµí•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. -> ê·¸ë¦¬ê³  ë§¤ê°œë³€ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ” í•¨ìˆ˜ì˜ ì´ë¦„ë§Œ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì´ ë¬´ì—‡ì¼ê¹Œë¥¼ ê³ ë ¤í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.

button íƒœê·¸ ë‚´ì— sort / filterë¥¼ ë¹„í™œì„±í™” ì‹œì¼°ê³ , ì»¬ëŸ¼ì˜ ë©”ë‰´ë¥¼ ë¹„í™œì„±í™” ì‹œí‚¤ëŠ” disableColumnMenuë¥¼ trueë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.
ê·¸ë¦¬ê³  onClick ì´ë²¤íŠ¸ë„ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.

ë‹¤ìŒ ê³¼ì •ì„ ì¢€ ê³ ë¯¼í•´ë´ì•¼ í•©ë‹ˆë‹¤. ê° rowë“¤ë§ˆë‹¤ hrefê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— delete ìš”ì²­ì„ ë‚ ë¦´ ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

í˜„ì¬ê¹Œì§€ì˜ì½”ë“œë¥¼ í™•ì¸í•´ë³¸ ê²°ê³¼ , ì¼ë‹¨ cardatabase_2ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ê¸ˆ back-front ì—°ê²°ì„ í•˜ê³  ìˆëŠ” ê²ƒì€ ë§ëŠ”ë°, ì–˜ê°€ Spring Data RESTë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ê³  ìˆë‹¤ë³´ë‹ˆê¹Œ ë¡œì§ ì„¤ëª…ì´ ë˜ê³  ìˆì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

ì¦‰, ì½”ë“œ ìì²´ë¥¼ ë³´ê³  ë¡œì§ì„ ë– ì˜¬ë¦¬ê¸° ìœ„í•´ì„œëŠ”cardatabase_4ì˜ CarControllerì™€ CarServiceë¥¼ í™•ì¸í•  í•„ìš”ê°€ ìˆë‹¤.

Axiosì˜ delete ë©”ì„œë“œë¥¼ ì´ìš©í•˜ì—¬ DELETE ìš”ì²­ì„ ë³´ë‚¼ê±´ë°, DELETE ìš”ì²­ì˜ ê²½ìš°ì—ëŠ” id ê°’ì´ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì„ CarServiceì—ì„œ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° id ê°’ì€ ì–´ë””ì— ìˆë‹¤? hrefì— ìˆë‹¤.

```ts
import axios from 'axios';
import { CarResponse } from '../types';

export const getCars = async (): Promise<CarResponse[]> => {
  const response = await axios.get(`${import.meta.env.VITE_API_URL}/api/cars`);

  return response.data._embedded.cars;
};

export const deleteCar = async (link: string): Promise<CarResponse> => {
  const response = await axios.delete(link);
  return response.data;
};
```

getCars()ì˜ return íƒ€ì…ê³¼ deleteCar()ì˜ returníƒ€ì…ì˜ ì°¨ì´ë¥¼ ìƒê°í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. getCars()ì˜ ê²½ìš° ìë™ì°¨ë“¤ì˜ ì •ë³´ë¥¼ ë‹´ê³ ìˆëŠ” ë°°ì—´ë§Œ ê°€ì§€ê³  ì™€ì„œ ê·¸ê²ƒì„ Carlist ì»´í¬ë„ŒíŠ¸ì˜ returnì— í‘œê¸°í•˜ë©´ë˜ëŠ” ë°˜ë©´ì—, ì‚­ì œ í›„ì—ëŠ” GETìš”ì²­ ì´í›„ì˜ ì™„ì „í•œ JSONì´ returnë  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ ì°¨ì´ë¡œ ì¸í•´ì„œ .\_embedded ìœ ë¬´ê°€ ê²°ì •ë‚˜ëŠ” ê²ë‹ˆë‹¤.

ê·¸ë¦¬ê³  ìš°ë¦¬ëŠ” í•¨ìˆ˜ë“¤ì„ frontendì—ì„œ ë‹¤ ë¶„ë¦¬ í–ˆìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ deleteCar í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì•¼ í•˜ëŠ” íŒŒì¼ì€ ì–´ë””ê°€ ë ê¹Œìš”?

í˜„ì¬ deleteCar() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ useMutation() hookì„ ì ìš©í–ˆìŠµë‹ˆë‹¤ ê·¸ë¦¬ê³  ì‚­ì œ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ, ì‚­ì œê°€ DBì—ì„œëŠ” ëì§€ë§Œ frontendìƒì—ì„œëŠ” ìƒˆë¡œê³ ì¹¨ì„ í•´ì•¼ì§€ë§Œ ì´ë£¨ì–´ì§„ë‹¤ëŠ” ì ë„ í™•ì¸ë˜ì£ .

ê·¸ë ‡ë‹¤ë©´ onSuccess ëŠ” ì‚­ì œ ì´í›„ì—, ìƒˆë¡œ í”„ë¡ íŠ¸ì—”ë“œì— ê°±ì‹  ë˜ cars ì „ë³´ë¥¼ ê°€ì§€ê³  ì˜¤ëŠ” ê²ƒì´ ë„ë¦¬ê²ë‹ˆë‹¤.

ì¦‰, ì´ì œ êµ¬í˜„í•  ë¶€ë¶„ì€ ìë™ì°¨ê°€ ì‚­ì œë˜ë©´ í”„ë¡ íŠ¸ì—”ë“œë¥¼ ìë™ìœ¼ë¡œ ìƒˆë¡œê³ ì¹¨ í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. react queryì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ëŠ” ì¿¼ë¦¬ í´ë¼ì´ì–¸íŠ¸ê°€ ì²˜ë¦¬í•˜ëŠ” ìºì‹œì— ì €ì¥ë©ë‹ˆë‹¤. ì¿¼ë¦¬ í´ë¼ì´ì–¸íŠ¸ì—ëŠ” ë°ì´í„°ë¥¼ ë‹¤ì‹œ ê°€ì ¸ì˜¤ëŠ”ë° ì´ìš© í•  ìˆ˜ ìˆëŠ” ì¿¼ë¦¬ ë¬´íš¨í™” ê¸°ëŠ¥ì´ìˆë‹¤.

ë¬¼ë¡  useEffect()ì—ì„œ ì½œë°±í•¨ìˆ˜ë¥¼ í†µí•´ getCars()ë¥¼ í˜¸ì¶œí•˜ëŠ”ë°, `['cars']`ë¥¼ í†µí•´ì„œ carsì˜ ìƒíƒœê°€ ë³€í™”ë  ë•Œë§ˆë‹¤ ì œë Œë”ë§ì„ ì¼ìœ¼í‚¤ëŠ” ë°©ë²•ì´ ìˆë‹¤. ê·¸ëŸ°ë° í˜„ì¬ ì €í¬ê°€ ì‘ì„±í•œ ë°©ì‹ì„ ë´¤ì„ ë•Œ , useStateë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ê³ , useQueryë¥¼ í†µí•´ getCars()ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆëŠ” ìƒí™©ì´ê¸° ë•Œë¬¸ì— cacheì— carsë°ì´í„°ê°€ ì €ì¥ë¼ìˆì„ê±°ë€ ì ì„ ì´ìš©í•´ì„œ

ì¿¼ë¦¬ ë¬´íš¨í™” ê¸°ëŠ¥ì„ ì ìš©í•˜ê¸° ìœ„í•´ ë¨¼ì € í˜„ì¬ì˜ ì¿¼ë¦¬ í´ë¼ì´ì–¸íŠ¸ë¥¼ ë°˜í™˜í•˜ëŠ” useQueryClient í›… í•¨ìˆ˜ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.

```tsx
import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';
import { getCars, deleteCar } from '../api/carapi';
import { DataGrid, GridColDef, GridCellParams } from '@mui/x-data-grid';

function CarList() {
  const queryClient = useQueryClient();

  const { data, error, isSuccess } = useQuery({
    queryKey: ['cars'],
    queryFn: getCars,
  });
```

## í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ

ì´ìƒì—ì„œ êµ¬í˜„í•œ ë¶€ë¶„ì€ ì‚­ì œë¥¼ í–ˆì„ ë•Œ, cacheë¥¼ í™•ì¸í•˜ì—¬ ìµœì‹ ì •ë³´ë¥¼ ê°€ì§€ê³  ì˜¤ëŠ” ë°©ì‹ì„ íƒí–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ 1ë²ˆ idë¥¼ ê°€ì§€ëŠ” ì• ë¥¼ ì‚­ì œí–ˆì„ ë•Œì•¼ ë°”ë¡œ ìœ„ì— ë­ê°€ ì—†ì–´ì¡ŒëŠ”ì§€ ë³´ì´ê²Ÿì§€ë§Œ 20ê°œ ì¤‘ì— 12 ë²ˆ ì¯¤ ë˜ëŠ” ì• ë¥¼ ì‚­ì œí•˜ë©´ ë Œë”ë§ ëì„ ë•Œ ë‹¤ì‹œ 1 ë²ˆë¶€í„° ë‚˜ì˜¬ê±°ë‹ˆê¹Œ ì œëŒ€ë¡œ ì§€ì›Œì¡ŒëŠ”ì§€ë¥¼ ì²´í¬í•˜ê¸° í˜ë“¤ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

ì¦‰ UX ê°œì„ ì„ ìœ„í•˜ì—¬ ì‚­ì œê°€ ë˜ì—ˆë‹¤ê³  í‘œì‹œë¥¼ í•´ì£¼ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
ê·¸ëŸ°ë° alertì€ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ

### SnackBar

- ì—¬ëŸ¬ë¶„ë“¤ì´ ì£¼ëª©í•´ì•¼ í•  ê²ƒì€ ì €í¬ê°€ shoppinglist ì•±ì—ì„œ ë„ì…í–ˆë˜ Modalê³¼ ìœ ì‚¬í•œ ì„±ì§ˆì„ ì§€ë‹ˆê³  ìˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ê·¸ë˜ì„œ ë™ì¼í•˜ê²Œ
  `  const [open, setOpen] = useState(false);`
  ê·¸ë ‡ë‹¤ë©´ íŠ¹ì • ìƒí™©ì´ ë°œìƒí–ˆì„ ë•Œ setOpen(true)ë¥¼ í†µí•´ì„œ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ê³ , ë‹¤ì‹œ setOpen(false)ë¥¼ í†µí•´ì„œ ê·¸ ë©”ì‹œì§€ê°€ ì‚¬ë¼ì ¸ì•¼ ê² ë„¤ìš”.

shoppinglistì—ì„œëŠ” add item ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ openì´ trueë¡œ ë°”ë€Œì–´ì„œ modalì°½ì´ ë Œë”ë§ëìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ ì‚­ì œ í›„ì— ì‚­ì œë˜ì—ˆë‹¤ê³  ë©”ì‹œì§€ë¥¼ ë„ìš°ê³  ì‹¶ë‹¤ë©´, Carlistì—ì„œ ì–´ëŠ ë¶€ë¶„ì— setOpen(true)ê°€ ìˆì–´ì•¼ í•œë‹¤.

## confirm ìƒì ì¶”ê°€í•˜ê¸°

button íƒœê·¸ ìˆ˜ì •.

```tsx
// import { CarResponse } from '../types';
import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';
import { getCars, deleteCar } from '../api/carapi';
import { DataGrid, GridColDef, GridCellParams } from '@mui/x-data-grid';
import { Snackbar } from '@mui/material';
import { useState } from 'react';

function CarList() {
  const [open, setOpen] = useState(false);
  const queryClient = useQueryClient();

  const { data, error, isSuccess } = useQuery({
    queryKey: ['cars'],
    queryFn: getCars,
  });

  const { mutate } = useMutation(deleteCar, {
    onSuccess: () => {
      setOpen(true);
      queryClient.invalidateQueries({ queryKey: ['cars'] }); // ì´ë¶€ë¶„ì€ useQuery()ë¥¼ ì •ì˜í•œ ë¶€ë¶„ê³¼ ê´€ë ¨ìˆë‹¤.
    },
    onError: (err) => {
      console.log(err);
    },
  });

  const columns: GridColDef[] = [
    { field: 'brand', headerName: 'Brand', width: 200 },
    { field: 'model', headerName: 'Model', width: 200 },
    { field: 'color', headerName: 'Color', width: 200 },
    { field: 'registrationNumber', headerName: 'Reg.nr', width: 150 },
    { field: 'modelYear', headerName: 'Model Year', width: 150 },
    { field: 'price', headerName: 'Price', width: 150 },
    {
      field: 'delete',
      headerName: '',
      width: 90,
      sortable: false,
      filterable: false,
      disableColumnMenu: true,
      renderCell: (params: GridCellParams) => (
        <button
          onClick={() => {
            if (window.confirm(`${params.row.brand}ì˜ ${params.row.model}ìë™ì°¨ë¥¼ ì‚­ì œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
              mutate(params.row._links.self.href);
            }
          }}
        >
          Delete
        </button>
      ),
    },
  ];

  if (!isSuccess) {
    return <span>Loading...ğŸ•</span>;
  }

  if (error) {
    return <span>ìë™ì°¨ë“¤ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤ğŸš—... </span>;
  } else {
    return (
      <>
        <DataGrid rows={data} columns={columns} getRowId={(row) => row._links.self.href} />
        <Snackbar
          open={open}
          autoHideDuration={2000}
          onClose={() => setOpen(false)}
          message='ì„ íƒí•œ ìë™ì°¨ ì •ë³´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.'
        />
      </>
      // <table>
      //   <tbody>
      //     {data.map((car: CarResponse) => (
      //       <tr key={car._links.self.href}>
      //         <td>{car.brand}</td>
      //         <td>{car.model}</td>
      //         <td>{car.color}</td>
      //         <td>{car.registrationNumber}</td>
      //         <td>{car.modelYear}</td>
      //         <td>{car.price}</td>
      //       </tr>
      //     ))}
      //   </tbody>
      // </table>
    );
  }
}

export default CarList;
```

# ìƒì„± ê¸°ëŠ¥ ì¶”ê°€

## MUI ëª¨ë‹¬ í¼ ì´ìš©í•˜ì—¬

Car rowë¥¼ ì¶”ê°€í• ìˆ˜ ìˆë„ë¡ í•  ì˜ˆì •ì…ë‹ˆë‹¤. New Carë¼ê³  í•˜ëŠ” ë²„íŠ¼ì„ ì¶”ê°€í•˜ì—¬ ëˆ„ë¥´ë©´ ëª¨ë‹¬ í¼ì´ ì—´ë¦¬ê²Œ í• ê²ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ëª¨ë‹¬ í¼ ë‚´ì—ëŠ” ì—¬ëŸ¬ê°œì˜ inputì´ ìˆì–´ì•¼ entity ìƒì—ì„œ final/@Nonnullì´ ìˆëŠ” fieldì— ëŒ€í•œ ëª¨ë“  ì…ë ¥ì„ ë°›ê³ , ì´ë¥¼ ì €ì¥í•˜ê±°ë‚˜ ì·¨ì†Œí•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì„ ë‚´ë¶€ì— êµ¬í˜„í•  ì˜ˆì •ì…ë‹ˆë‹¤.

```tsx
//AddCar.tsx
import { Button, Dialog, DialogActions, DialogContent, DialogTitle } from '@mui/material';
import { Car } from '../types';
import { ChangeEvent, useState } from 'react';

function AddCar() {
  const [open, setOpen] = useState(false);
  const [car, setCar] = useState<Car>({
    brand: '',
    model: '',
    color: '',
    registrationNumber: '',
    modelYear: 0,
    price: 0,
  });

  const handleClickOpen = () => setOpen(true);

  const handleClickClose = () => setOpen(false);

  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {
    setCar({ ...car, [e.target.name]: e.target.value });
  };

  return (
    <>
      <button onClick={handleClickOpen}>New Car</button>
      <Dialog open={open} onClose={handleClickClose}>
        <DialogTitle>New Car</DialogTitle>
        <DialogContent>
          <input type='text' name='brand' value={car.brand} placeholder='Brand' onChange={handleChange} />
          <br />
          <input type='text' name='model' value={car.model} placeholder='Model' onChange={handleChange} />
          <br />
          <input type='text' name='color' value={car.color} placeholder='Color' onChange={handleChange} />
          <br />
          <input
            type='text'
            name='registrationNumber'
            value={car.registrationNumber}
            placeholder='Reg.No'
            onChange={handleChange}
          />
          <br />
          <input type='text' name='modelYear' value={car.modelYear} placeholder='ModelYear' onChange={handleChange} />
          <br />
          <input type='text' name='price' value={car.price} placeholder='Price' onChange={handleChange} />
          <br />
        </DialogContent>
        <button onClick={handleClickClose}>Cancel | ì·¨ì†Œ</button>
        <button onClick={handleClickClose}>Add | ì €ì¥</button>
      </Dialog>
    </>
  );
}

export default AddCar;
```

ë‚˜ì¤‘ì— html íƒœê·¸ë¥¼ muië¡œ ê°ˆì•„ ë¼ìš¸ê²ë‹ˆë‹¤.
í˜„ì¬ê¹Œì§€ ì‘ì„±í–ˆì„ ë•Œ ë¸Œë¼ìš°ì € ìƒì—ì„œì˜ í™”ë©´ì€ ì–´ëŠì •ë„ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.
ê·¸ëŸ¼ í˜„ì¬ê¹Œì§€ìœ¼ ã…£ìƒí™©ì—ì„œ ì´í›„ì˜ ì‘ì„± ìˆœì„œëŠ”
axios.postë¥¼ í†µí•´ì„œ dbë¡œ ì§€ê¸ˆ ë°ì´í„° ê°’ì„ ë„˜ê²¨ì„œ ì €ì¥í•  ìˆ˜ ìˆì–´ì•¼ í•  ê²ƒì´ê³ ,
ì €ì¥ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´ ê°±ì‹ ë˜ getCars()ë¥¼ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤.
ë˜í•œ ì €ì¥/ì·¨ì†Œê°€ ëœ ì´í›„ì— inputì°½ì´ ì´ˆê¸°í™”ë˜ëŠ” ê²ƒë„ ê³ ë ¤í•´ë³¼ë§Œí•©ë‹ˆë‹¤.
(ê·¸ëŸ¬ë©´ ìˆ˜ì • ë•ŒëŠ” ì´ˆê¸°í™”ëœ inputì´ ì•„ë‹ˆë¼ ê¸°ì¡´ ê°’ë“¤ì´ ë¶ˆëŸ¬ì™€ì ¸ì•¼ ê² ë„¤ìš”)

---

## useMutation

```jsx
import { useMutation } from '@tanstack/react-query';
// useMutationì´ return í•˜ëŠ” ê°ì²´ì—ëŠ” ì´ ì„¸ê°€ì§€ ë§ê³ ë„ ì—¬ëŸ¬ ì†ì„±ê°’ì´ ìˆìŠµë‹ˆë‹¤.
const { data, isLoading, mutate } = useMutation(mutationFn, options);
```

useQueryê°€ GET ìš”ì²­ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ ì˜¤ëŠ”ë° ì‚¬ìš©ëœë‹¤ë©´ useMutationì€ **React Queryë¥¼ ì´ìš©í•´ ì„œë²„ì— ë°ì´í„° ë³€ê²½ ì‘ì—…ì„ ìš”ì²­í•  ë•Œ ì‚¬ìš©**í•©ë‹ˆë‹¤. `isLoading` ê³¼ `data`ëŠ” useQueryì™€ ê°™ì´ ì™„ë£Œ ì—¬ë¶€ì™€, ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ì§€ë§Œ `mutate`ì€ mutationFnìœ¼ë¡œ ì œê³µëœ í•¨ìˆ˜ë¥¼ ì‘ë™ì‹œí‚¤ëŠ” íŠ¸ë¦¬ê±° í•¨ìˆ˜ì…ë‹ˆë‹¤.

**useMutationì— ë“¤ì–´ê°€ëŠ” ì¸ì ê°’**

1. `mutationFn`: ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê³  ì—…ë°ì´íŠ¸í•˜ê³  ì‚­ì œí•˜ëŠ”ë° ì‚¬ìš©í•  í•¨ìˆ˜ì…ë‹ˆë‹¤. fetchë‚˜ axiosë¥¼ ì‚¬ìš©í•˜ì—¬ promiseë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ê°€ ì™€ì•¼í•©ë‹ˆë‹¤.
2. `options`: useMutationì—ë„ ë§ì€ ì˜µì…˜ì´ ìˆì§€ë§Œ ë§ì´ ì“°ëŠ” 4ê°€ì§€ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤.
   - `onMutate`: Promise ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” Callback í•¨ìˆ˜ë¡œì¨ mutation í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê¸° ì „ì— ì‹¤í–‰ë˜ê³  mutation í•¨ìˆ˜ì™€ ë™ì¼í•œ ë³€ìˆ˜ê°€ ì œê³µë©ë‹ˆë‹¤.
   - `onError`: mutationì´ ì‹¤íŒ¨í•œ ê²½ìš° ì‹¤í–‰í•  Callback í•¨ìˆ˜ ì…ë‹ˆë‹¤.
   - `onSettled`: mutationì´ ì‹¤íŒ¨ ë˜ëŠ” ì„±ê³µ ì—¬ë¶€ì— ê´€ê³„ ì—†ì´ ì‹¤í–‰í•  Callback í•¨ìˆ˜ ì…ë‹ˆë‹¤.
   - `onSuccess`: mutationì´ ì„±ê³µí•œ ê²½ìš° ì‹¤í–‰í•  Callback í•¨ìˆ˜ ì…ë‹ˆë‹¤.

ì•„ë˜ëŠ” ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œì…ë‹ˆë‹¤.

```jsx
// getPosts  í•¨ìˆ˜ëŠ” ê²Œì‹œë¬¼ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
export const getPosts = async () => {
  const { data } = await axios.get('http://localhost:8080/post');
  return data;
};

// createPost í•¨ìˆ˜ëŠ” ê²Œì‹œë¬¼ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
export const createPost = async (title, content) => {
  await axios.post('http://localhost:8080/post', {
    title,
    content,
  });
};
```

---

```jsx
import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';
import { getPosts, createPost } from './api.js';

export default function App() {
  const queryClient = useQueryClient();
  const { isLoading, data: posts } = useQuery('posts', getPosts);
  const createMutate = useMutation(
    ({ title, content }) => {
      createPost(title, content);
    },
    {
      onSuccess: () => {
        // ë¹„ë™ê¸° í†µì‹ ì´ ì„±ê³µì ìœ¼ë¡œ ì´ë£¨ì–´ ì¡Œì„ë•Œ
        // posts ë¼ëŠ” queryKeyë¥¼ ì°¾ì•„ ë°ì´í„°ë¥¼ ìƒˆë¡œ ë°›ì•„ì˜µë‹ˆë‹¤.
        queryClient.invalidateQueries('posts');
      },
    }
  );

  const handleSubmit = async (e) => {
    e.preventDefault();
    const { title, content } = e.target;

    // ìœ„ì—ì„œ ì„ ì–¸í•œ createMutateì˜ mutateí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ createPost í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤.
    createMutate.mutate({ title: title.value, content: content.value });
  };

  return (
    <div>
      <form onSubmit={handleSubmit}>{...ì¤‘ëµ}</form>
      {isLoading ? 'LOADING...' : posts.map((post, index) => <div>{`${index}) ${post.title}`}</div>)}
    </div>
  );
}
```

useMutationë¥¼ ì‚¬ìš©í•´ ìƒì„±, ì—…ë°ì´íŠ¸, ì‚­ì œ ë“±ì˜ ì²˜ë¦¬ í•  ìˆ˜ ìˆê³ , queryClientê°€ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” Query keyë¼ë©´ queryClient.invalidateQueries(queryKey)ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì†ì‰½ê²Œ ê°±ì‹  í•´ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°ì´í„°ë¥¼ ê°±ì‹ í•˜ëŠ” ë°©ë²•ì€ ì´ ë°–ì—ë„ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ì´ ìˆì§€ë§Œ ì—¬ê¸°ì„œëŠ” invalidateQueries ë§Œ ë‹¤ë£¨ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤.
ì´ ë°–ì—ë„ React-Queryì˜ ê°€ëŠ¥ì„±ì€ ë¬´ê¶ë¬´ì§„í•©ë‹ˆë‹¤. í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ëŒ€í•´ ì¡°ê¸ˆ ë” ì•Œê³  ì‹¶ë‹¤ë©´ ê³µì‹ ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•´ ì£¼ì„¸ìš”.
